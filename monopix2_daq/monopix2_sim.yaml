
---
name    : monopix_daq
version : 0.0.1

transfer_layer:
    - name  : intf
      type  : monopix2_daq.sim.SiSim
      init : 
        timeout  : 600
        bit_file : ../firmware/bit/monopix_mio.bit
        avoid_download : True
hw_drivers:
  - name      : tb
    type      : monopix2_daq.testbench
    interface : intf
    base_addr : 0x12000

  - name      : fifo
    type      : sram_fifo
    interface : intf
    base_addr : 0x18000
    base_data_addr: 0x1000000000000

  - name      : gpio
    type      : gpio
    interface : intf
    base_addr : 0x10010
    size      : 16

  - name      : spi
    type      : spi
    interface : intf
    base_addr : 0x15000

  - name      : data_rx       # 0
    type      : monopix2_daq.mono_data_rx
    interface : intf
    base_addr : 0x10500

  - name      : timestamp_inj  #5
    type      : monopix2_daq.timestamp640
    interface : intf
    base_addr : 0x10900
    size      : 8

  - name      : timestamp_mon  #6
    type      : monopix2_daq.timestamp640
    interface : intf
    base_addr : 0x10a00

  - name      : inj
    type      : pulse_gen
    interface : intf
    base_addr : 0x10300

  - name      : gate
    type      : pulse_gen
    interface : intf
    base_addr : 0x10400

registers:
#  - name        : Curr_Mon
#    type        : FunctionalRegister
#    hw_driver   : GPAC
#    arg_names   : [ value ]
#    arg_add     : { 'channel': 'ISRC0'}

  - name        : CONF
    type        : StdRegister
    hw_driver   : gpio
    size        : 16
    fields :
      - name    : READ_PATTERN
        size    : 1
        offset  : 15
      - name    : ResetBcid_WITH_TIMESTAMP
        size    : 1
        offset  : 10
      - name    : LVDS_Out
        size    : 1
        offset  : 8
      - name    : EN_GATE
        size    : 1
        offset  : 7
      - name    : ResetBcid
        size    : 1
        offset  : 6
      - name    : ClkOut
        size    : 1
        offset  : 5
      - name    : ClkBX
        size    : 1
        offset  : 4
      - name    : Def_Conf
        size    : 1
        offset  : 3
      - name    : Ld_Cnfg
        size    : 1
        offset  : 2
      - name    : Ld_DAC
        size    : 1
        offset  : 1
      - name    : Rst
        size    : 1
        offset  : 0

  - name        : CONF_SR
    type        : StdRegister
    hw_driver   : spi
    size        : 19267
    auto_start  : True 
    init        :
        BLRes     : 32
        VAmp      : 31
        VPFB      : 30
        VPFoll    : 12
        VNLoad    : 11
        TDAC_LSB  : 48
        Vsf       : 33
        Mon_Vsf   : 1
        Mon_VPFB  : 0
        Mon_VLoad : 0
        Mon_VFoll : 0
        Mon_VAmp  : 0
        Mon_LSBdacL   : 0
        Mon_BLRes : 0
        EnDataCMOS    : 1
        EnDataLVDS    : 0
        EnTestPattern : 0
        EnColRO   : 0xFFFFFFFFFFFFFF
        InjEnCol  : 32
        EnMonitorCol: 32
        TrimLd    : 15
        EnInjLd   : 1
        EnMonitorLd   : 1
        EnPreLd   : 1

    fields:
        - name     : Vsf
          size     : 6
          offset   : 5
        - name     : TDAC_LSB
          size     : 6
          offset   : 11
        - name     : VNLoad
          size     : 6
          offset   : 17
        - name     : VPFoll
          size     : 6
          offset   : 23
        - name     : VPFB
          size     : 6
          offset   : 29
        - name     : VAmp
          size     : 6
          offset   : 35
        - name     : BLRes
          size     : 6
          offset   : 41

        - name     : Mon_Vsf
          size     : 1
          offset   : 42
        - name     : Mon_VPFB
          size     : 1
          offset   : 43
        - name     : Mon_VLoad
          size     : 1
          offset   : 44
        - name     : Mon_VFoll
          size     : 1
          offset   : 45
        - name     : Mon_VAmp
          size     : 1
          offset   : 46
        - name     : Mon_LSBdacL
          size     : 1
          offset   : 47
        - name     : Mon_BLRes
          size     : 1
          offset   : 48
        - name     : EnDataLVDS
          size     : 1
          offset   : 49
        - name     : EnDataCMOS
          size     : 1
          offset   : 50
        - name     : EnTestPattern
          size     : 1
          offset   : 51
        - name     : EnColRO
          size     : 56
          offset   : 107
        - name     : InjEnCol
          size     : 56
          offset   : 163
        - name     : EnMonitorCol
          size     : 56
          offset   : 219

        - name     : TrimLd
          size     : 4
          offset   : 223
        - name     : EnInjLd
          size     : 1
          offset   : 224
        - name     : EnMonitorLd
          size     : 1
          offset   : 225
        - name     : EnPreLd
          size     : 1
          offset   : 226

        - name     : Pixels
          size     : 19040
          offset   : 19266
